alert tcp any any -> any 80 (msg:"Slowloris Attack - Slow requisition";pcre:"/(^|\s)(GE|PO|HE)(\s|$)/i"; detection_filter:track by_src, count 20, seconds 10;sid:1000002;)
alert tcp any any -> any 80 (msg:"Slowhttptest - Slow POST Attack"; content:"PO", nocase; detection_filter:track by_src, count 3, seconds 120; sid:1000003;)
alert tcp any any -> any 80 (msg:"GoldenEye Attack - HTTP Flood (GET/POST/HEAD)"; pcre:"/(^|\s)(GE|PO|HE)(\s|$)/i"; detection_filter:track by_src, count 50, seconds 10; sid:1000004;)
alert tcp any any -> any 80 (msg:"Hulk Attack - HTTP Flood";content:"GE",nocase, offset 0; detection_filter:track by_src, count 100, seconds 5;sid:1000005;)


alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 6bffd098-a112-3610-9833-46c3f87e345a; dce_opnum:"5"; dce_stub_data; byte_extract:4,64,array_elements,dce,multiplier 20; byte_test:4,>,array_elements,-12,relative,dce; metadata:policy max-detect-ips drop,policy security-ips alert; service:netbios-ssn; reference:cve,2012-1182; classtype:attempted-admin; sid:21806; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 12345778-1234-abcd-ef00-0123456789ac; dce_opnum:"16"; dce_stub_data; byte_extract:4,20,num_sids,dce; byte_test:4,<,num_sids,4,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22004; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 12345778-1234-abcd-ef00-0123456789ab; dce_opnum:"8"; dce_stub_data; byte_extract:4,32,array_count,dce; byte_test:4,<,array_count,0,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22005; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 12345778-1234-abcd-ef00-0123456789ac; dce_opnum:"67"; dce_stub_data; byte_extract:4,44,pwd_hist_len,dce; byte_test:4,<,pwd_hist_len,24,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22006; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 12345778-1234-abcd-ef00-0123456789ab; dce_opnum:"14"; dce_stub_data; byte_extract:4,20,num_names,dce; byte_test:4,<,num_names,0,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22007; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 82273fdc-e32a-18c3-3f78-827929dc23ea; dce_opnum:"11"; dce_stub_data; byte_extract:4,40,array_elements,dce,multiplier 4; byte_test:2,<,array_elements,-8,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22008; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 367abb81-9844-35f1-ad32-98f038001003; dce_opnum:"19"; dce_stub_data; byte_extract:4,20,num_args,dce; byte_test:4,<,num_args,4,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22009; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 12345778-1234-abcd-ef00-0123456789ab; dce_opnum:"40"; dce_stub_data; byte_extract:4,40,num_entries,dce; byte_test:4,>,num_entries,0,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22010; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 4fc742e0-4a10-11cf-8273-00aa004ae673; dce_opnum:"5"; dce_stub_data; byte_extract:4,24,array_count,dce; byte_test:4,<,array_count,4,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22011; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 4fc742e0-4a10-11cf-8273-00aa004ae673; dce_opnum:"3"; dce_stub_data; byte_extract:4,44,num_stores,dce; byte_test:4,<,num_stores,4,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:22012; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba malicious user defined array size and buffer attempt"; flow:to_server,established; dce_iface:uuid 82273fdc-e32a-18c3-3f78-827929dc23ea; dce_opnum:"11"; dce_stub_data; byte_extract:2,32,array_elements,dce,multiplier 1; byte_test:4,<,array_elements,2,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2012-1182; reference:url,www.samba.org/samba/security/CVE-2012-1182; classtype:attempted-admin; sid:23240; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"SERVER-SAMBA Samba smbd _netr_ServerPasswordSet deprecated vulnerable function access attempt"; flow:to_server,established; dce_iface:uuid 12345678-1234-abcd-ef00-01234567cffb; dce_opnum:"6"; metadata:policy max-detect-ips drop; service:dcerpc,netbios-ssn; reference:bugtraq,72711; reference:cve,2015-0240; reference:url,securityblog.redhat.com/2015/02/23/samba-vulnerability-cve-2015-0240/; classtype:policy-violation; gid:1; sid:33826; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS UDP inverse query"; flow:to_server; byte_test:1,<,16,2; byte_test:1,&,8,2; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,2321; reference:cve,2001-0012; reference:nessus,10605; classtype:attempted-recon; sid:2921; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS TCP inverse query"; flow:to_server,established; byte_test:1,<,16,4; byte_test:1,&,8,4; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,2321; reference:cve,2001-0012; reference:nessus,10605; classtype:attempted-recon; sid:2922; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS TCP inverse query overflow"; flow:to_server,established; byte_test:1,<,16,4; byte_test:1,&,8,4; isdataat:400; metadata:ruleset community; service:dns; reference:bugtraq,134; reference:cve,1999-0009; classtype:attempted-admin; sid:3153; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 53 ( msg:"PROTOCOL-DNS UDP inverse query overflow"; flow:to_server; isdataat:400; byte_test:1,<,16,2; byte_test:1,&,8,2; metadata:policy max-detect-ips drop,ruleset community; service:dns; reference:bugtraq,134; reference:cve,1999-0009; classtype:attempted-admin; sid:3154; rev:12; )
alert udp $EXTERNAL_NET 53 -> $HOME_NET any ( msg:"PROTOCOL-DNS large number of NXDOMAIN replies - possible DNS cache poisoning"; flow:to_client,no_stream; byte_test:1,&,2,3; byte_test:1,&,1,3; byte_test:1,&,128,2; detection_filter:track by_src,count 1000,seconds 5; metadata:policy max-detect-ips drop; service:dns; reference:cve,2008-1447; reference:cve,2009-0233; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-008; reference:url,www.kb.cert.org/vuls/id/800113; classtype:misc-attack; sid:13948; rev:13; )
alert udp $HOME_NET 53 -> $EXTERNAL_NET any ( msg:"PROTOCOL-DNS excessive outbound NXDOMAIN replies - possible spoof of domain run by local DNS servers"; flow:to_client,no_stream; byte_test:1,&,2,3; byte_test:1,&,1,3; byte_test:1,&,128,2; detection_filter:track by_dst,count 1000,seconds 5; metadata:policy max-detect-ips drop; service:dns; reference:cve,2008-1447; reference:cve,2009-0233; reference:cve,2012-0006; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-008; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-017; reference:url,www.kb.cert.org/vuls/id/800113; classtype:misc-attack; sid:13949; rev:17; )
alert tcp $EXTERNAL_NET 10101 -> $HOME_NET any ( msg:"INDICATOR-SCAN myscan"; flow:stateless; ack:0; flags:S; ttl:>220; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:613; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 80 ( msg:"INDICATOR-SCAN cybercop os probe"; flow:stateless; isdataat:!0; flags:12FS; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:619; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SCAN ipEye SYN scan"; flow:stateless; flags:S; seq:1958810375; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:622; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"INDICATOR-SCAN synscan portscan"; flow:stateless; flags:FS; id:39426; metadata:ruleset community; reference:url,attack.mitre.org/techniques/T1018; reference:url,attack.mitre.org/techniques/T1040; reference:url,attack.mitre.org/techniques/T1046; classtype:attempted-recon; sid:630; rev:11; )
alert udp any any -> 255.255.255.255 161 ( msg:"PROTOCOL-SNMP Broadcast request"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1415; rev:18; )
alert udp any any -> 255.255.255.255 162 ( msg:"PROTOCOL-SNMP broadcast trap"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1416; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP request udp"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1417; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"PROTOCOL-SNMP request tcp"; flow:stateless; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1418; rev:19; )
alert udp $EXTERNAL_NET any -> $HOME_NET 162 ( msg:"PROTOCOL-SNMP trap udp"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1419; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 162 ( msg:"PROTOCOL-SNMP trap tcp"; flow:stateless; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1420; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 705 ( msg:"PROTOCOL-SNMP AgentX/tcp request"; flow:stateless; metadata:policy max-detect-ips drop,ruleset community; service:snmp; reference:bugtraq,4088; reference:bugtraq,4089; reference:bugtraq,4132; reference:cve,2002-0012; reference:cve,2002-0013; classtype:attempted-recon; sid:1421; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"NETBIOS DCERPC NCACN-IP-TCP winreg InitiateSystemShutdown attempt"; flow:to_server,established; dce_iface:uuid 338cd001-2244-31f1-aaaa-900038001003; dce_opnum:"24"; metadata:ruleset community; service:netbios-ssn; reference:url,msdn.microsoft.com/library/default.asp?url=/library/en-us/shutdown/base/initiatesystemshutdown.asp; classtype:protocol-command-decode; sid:2942; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6106 ( msg:"NETBIOS DCERPC NCACN-IP-TCP veritas bind attempt"; flow:to_server,established; dce_iface:uuid 93841fd0-16ce-11ce-850d-02608c44967b; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,14020; reference:cve,2005-0771; reference:url,www.idefense.com/application/poi/display?id=269&type=vulnerabilities; classtype:protocol-command-decode; sid:3697; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] ( msg:"NETBIOS DCERPC NCACN-IP-TCP msqueue function 1 overflow attempt"; flow:to_server,established; dce_iface:uuid 975201b0-59ca-11d0-a8d5-00a0c90d8051; dce_opnum:"1"; dce_stub_data; byte_test:4,>,128,20,dce; classtype:attempted-admin; sid:9772; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"NETBIOS DCERPC NCADG-IP-UDP msqueue function 1 overflow attempt"; dce_iface:uuid 975201b0-59ca-11d0-a8d5-00a0c90d8051; dce_opnum:"1"; dce_stub_data; byte_test:4,>,128,20,dce; metadata:policy max-detect-ips drop; classtype:attempted-admin; sid:9773; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6502 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc GetGroupStatus overflow attempt"; flow:to_server,established; dce_iface:uuid 62b93df0-8b02-11ce-876c-00805f842837; dce_opnum:"37"; dce_stub_data; byte_test:4,>,4096,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,21221; reference:cve,2006-6076; reference:url,www.lssec.com/advisories/LS-20060908.pdf; classtype:attempted-admin; sid:9806; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6502 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc ClientDBMiniAgentClose attempt"; flow:to_server,established; dce_iface:uuid 62b93df0-8b02-11ce-876c-00805f842837; dce_opnum:"191"; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,22010; reference:cve,2007-0168; reference:url,www.kb.cert.org/vuls/id/662400; reference:url,www.lssec.com/advisories/LS-20061002.pdf; classtype:protocol-command-decode; sid:10024; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6503 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor QSIGetQueuePath_Function_45 overflow attempt"; flow:to_server,established; dce_iface:uuid dc246bf0-7a7a-11ce-9f88-00805fe43838; dce_opnum:"45"; dce_stub_data; byte_test:4,>,1,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,20365; reference:cve,2006-5143; reference:cve,2006-6076; classtype:attempted-admin; sid:10030; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6503 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor ASRemotePFC overflow attempt"; flow:to_server,established; dce_iface:uuid dc246bf0-7a7a-11ce-9f88-00805fe43838; dce_opnum:"47"; dce_stub_data; byte_test:4,>,624,0,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,22005; reference:cve,2007-0169; reference:url,www.kb.cert.org/vuls/id/180336; classtype:attempted-admin; sid:10036; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [6503,6504] ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc2 ASDBLoginToComputer overflow attempt"; flow:to_server,established; dce_iface:uuid 506b1890-14c8-11d1-bbc3-00805fa6962e; dce_opnum:"117"; dce_stub_data; byte_test:4,>,119,0,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,22005; reference:cve,2007-0169; reference:url,www.kb.cert.org/vuls/id/180336; classtype:attempted-admin; sid:10050; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6502 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc GetGCBHandleFromGroupName overflow attempt"; flow:to_server,established; dce_iface:uuid 62b93df0-8b02-11ce-876c-00805f842837; dce_opnum:"207"; dce_stub_data; byte_test:4,>,1024,0,dce; metadata:policy max-detect-ips drop; reference:bugtraq,22005; reference:cve,2007-0169; classtype:attempted-admin; sid:10117; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"NETBIOS DCERPC-NCACN-IP-TCP ca alert function 16/23 overflow attempt"; flow:to_server,established; dce_iface:uuid 3d742890-397c-11cf-9bf1-00805f88cb72; dce_opnum:"16 23"; dce_stub_data; byte_test:4,>,200,12,dce; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:bugtraq,24947; reference:cve,2007-3825; reference:url,supportconnectw.ca.com/public/antivirus/infodocs/caantivirus-secnotice.asp; classtype:attempted-admin; sid:12100; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"NETBIOS DCERPC NCACN-IP-TCP spoolss OpenPrinter overflow attempt"; flow:to_server,established; dce_iface:uuid 12345678-1234-abcd-ef00-0123456789ab; dce_opnum:"1"; dce_stub_data; byte_test:4,>,458,4,dce; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:bugtraq,21220; reference:cve,2006-5854; classtype:attempted-admin; sid:12808; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6071 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc3 CA opcode 4 attempt"; flow:to_server,established; dce_iface:uuid 88435ee0-861a-11ce-b86b-00001b27f656; dce_opnum:"4"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,26015; reference:cve,2007-5329; classtype:protocol-command-decode; sid:12910; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6071 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc3 CA opcode 12 attempt"; flow:to_server,established; dce_iface:uuid 88435ee0-861a-11ce-b86b-00001b27f656; dce_opnum:"12"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,26015; reference:cve,2007-5329; classtype:protocol-command-decode; sid:12916; rev:13; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6071 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc3 CA opcode 16 attempt"; flow:to_server,established; dce_iface:uuid 88435ee0-861a-11ce-b86b-00001b27f656; dce_opnum:"16"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,26015; reference:cve,2007-5329; classtype:protocol-command-decode; sid:12922; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6071 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc3 CA opcode 18 attempt"; flow:to_server,established; dce_iface:uuid 88435ee0-861a-11ce-b86b-00001b27f656; dce_opnum:"18"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,26015; reference:cve,2007-5329; classtype:protocol-command-decode; sid:12928; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6071 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor-arc3 CA opcode 19 attempt"; flow:to_server,established; dce_iface:uuid 88435ee0-861a-11ce-b86b-00001b27f656; dce_opnum:"19"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:bugtraq,26015; reference:cve,2007-5329; classtype:protocol-command-decode; sid:12934; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"NETBIOS DCERPC NCACN-IP-TCP spoolss EnumPrinters overflow attempt"; flow:to_server,established; dce_iface:uuid 12345678-1234-abcd-ef00-0123456789ab; dce_opnum:"0"; dce_stub_data; byte_test:4,>,256,16,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:bugtraq,21220; reference:cve,2006-5854; reference:cve,2006-6114; reference:cve,2008-0639; classtype:attempted-admin; sid:13162; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6503 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor opcode 0x13 overflow attempt"; flow:to_server,established; dce_iface:uuid dc246bf0-7a7a-11ce-9f88-00805fe43838; dce_opnum:"19"; dce_stub_data; byte_test:4,=,1,0,dce; byte_test:4,>,64000,8,dce; byte_test:4,=,0,12,dce; byte_test:4,>,64000,16,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,35396; reference:cve,2009-1761; classtype:attempted-dos; sid:15702; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6503 ( msg:"NETBIOS DCERPC NCACN-IP-TCP brightstor opnum 43 overflow attempt"; flow:to_server,established; dce_iface:uuid dc246bf0-7a7a-11ce-9f88-00805fe43838; dce_opnum:"43"; dce_stub_data; byte_test:4,>,624,0,dce; metadata:policy max-detect-ips drop; reference:bugtraq,22005; reference:cve,2007-0169; reference:url,www.kb.cert.org/vuls/id/180336; classtype:attempted-admin; sid:17640; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"NETBIOS DCERPC possible wmi remote process launch"; flow:to_server,established; dce_iface:uuid 00000143-0000-0000-c000-000000000046; metadata:policy max-detect-ips drop; service:dcerpc; reference:url,attack.mitre.org/techniques/T1047; reference:url,attack.mitre.org/techniques/T1084; reference:url,car.mitre.org/wiki/CAR-2014-12-001; classtype:policy-violation; sid:43370; rev:3; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft WIndows IGMP dos attack"; fragbits:M+; ip_proto:2; metadata:ruleset community; reference:bugtraq,514; reference:cve,1999-0918; reference:url,technet.microsoft.com/en-us/security/bulletin/MS99-034; classtype:attempted-dos; sid:272; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP lsass DsRolerUpgradeDownlevelServer overflow attempt"; flow:to_server,established; dce_iface:uuid 3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:"9"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-admin; sid:2508; rev:24; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,138,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP lsass DsRolerUpgradeDownlevelServer overflow attempt"; dce_iface:uuid 3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:"9"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop,ruleset community; service:netbios-dgm; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:attempted-admin; sid:2511; rev:22; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP llsrpc LlsrConnect overflow attempt"; flow:to_server,established; dce_iface:uuid 342cfd40-3c6c-11ce-a893-08002b2e9c6d; dce_opnum:"0"; dce_stub_data; byte_test:4,>,52,0,dce; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:netbios-ssn; reference:bugtraq,12481; reference:cve,2005-0050; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-010; classtype:attempted-admin; sid:3114; rev:20; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msqueue function 4 overflow attempt"; dce_iface:uuid 975201b0-59ca-11d0-a8d5-00a0c90d8051; dce_opnum:"4"; dce_stub_data; byte_test:4,>,128,8,dce; metadata:policy max-detect-ips drop,policy security-ips drop,ruleset community; service:dcerpc; reference:cve,2005-0059; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-017; classtype:attempted-admin; sid:3171; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP winreg OpenKey overflow attempt"; flow:to_server,established; dce_iface:uuid 338cd001-2244-31f1-aaaa-900038001003; dce_opnum:"15"; dce_stub_data; byte_test:2,>,1024,20,dce; metadata:ruleset community; service:netbios-ssn; reference:bugtraq,1331; reference:cve,2000-0377; reference:url,technet.microsoft.com/en-us/security/bulletin/ms00-040; classtype:attempted-admin; sid:3218; rev:23; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP IActivation remoteactivation overflow attempt"; flow:to_server,established; dce_iface:uuid 4d9f4ab8-7d1c-11cf-861e-0020af6e7c57; dce_opnum:"0"; dce_stub_data; byte_test:4,>,256,52,dce; metadata:policy max-detect-ips drop,ruleset community; service:dcerpc,netbios-ssn; reference:bugtraq,8205; reference:cve,2003-0352; reference:cve,2003-0528; reference:cve,2003-0715; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-026; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:attempted-admin; sid:3409; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_QueryResConfList attempt"; flow:to_server,established; dce_iface:uuid 8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:"54"; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:bugtraq,14513; reference:cve,2005-1983; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-039; classtype:protocol-command-decode; sid:3967; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP locator nsi_binding_lookup_begin overflow attempt"; flow:to_server,established; dce_iface:uuid d3fbb514-0e3b-11cb-8fad-08002b1d29c3; dce_opnum:"0"; dce_stub_data; byte_test:4,>,256,8,dce; service:netbios-ssn; reference:bugtraq,6666; reference:cve,2003-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-001; classtype:attempted-admin; sid:4754; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP locator nsi_binding_lookup_begin overflow attempt"; dce_iface:uuid d3fbb514-0e3b-11cb-8fad-08002b1d29c3; dce_opnum:"0"; dce_stub_data; byte_test:4,>,256,8,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,6666; reference:cve,2003-0003; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-001; classtype:attempted-admin; sid:4755; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetRootDeviceInstance attempt"; flow:to_server,established; dce_iface:uuid 8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:"7"; dce_stub_data; byte_test:4,>,256,0,dce; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:bugtraq,15460; reference:cve,2005-3644; reference:url,technet.microsoft.com/en-us/security/advisory/911052; classtype:protocol-command-decode; sid:4826; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP umpnpmgr PNP_GetDeviceList dos attempt"; flow:to_server,established; dce_iface:uuid 8d9f4e40-a03d-11ce-8f69-08003e30051b; dce_opnum:"10"; dce_stub_data; byte_test:4,>,256,4,dce; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:bugtraq,15460; reference:cve,2005-3644; reference:url,technet.microsoft.com/en-us/security/advisory/911052; classtype:protocol-command-decode; sid:4918; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP lsass DsRolerGetPrimaryDomainInformation attempt"; flow:to_server,established; dce_iface:uuid 3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:"0"; service:netbios-ssn; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:protocol-command-decode; sid:5095; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,138,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP lsass DsRolerGetPrimaryDomainInformation attempt"; dce_iface:uuid 3919286a-b10c-11d0-9ba8-00c04fd92ef5; dce_opnum:"0"; metadata:policy max-detect-ips drop; reference:bugtraq,10108; reference:cve,2003-0533; reference:nessus,12205; reference:url,technet.microsoft.com/en-us/security/bulletin/MS04-011; classtype:protocol-command-decode; sid:5096; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP llsrpc2 LlsrLicenseRequestW overflow attempt"; flow:to_server,established; dce_iface:uuid 57674cd0-5200-11ce-a897-08002b2e9c6d; dce_opnum:"0"; dce_stub_data; byte_test:4,>,256,8,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:bugtraq,12481; reference:cve,2005-0050; reference:cve,2009-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-064; reference:url,technet.microsoft.com/en-us/security/bulletin/ms05-010; classtype:attempted-admin; sid:5485; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContextW invalid uuid size attempt"; flow:to_server,established; dce_iface:uuid 906b0ce0-c70b-1067-b317-00dd010662da; dce_opnum:"7"; dce_stub_data; byte_test:4,>,37,28,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,17905; reference:cve,2006-1184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6419; rev:16; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP msdtc BuildContextW invalid uuid size attempt"; dce_iface:uuid 906b0ce0-c70b-1067-b317-00dd010662da; dce_opnum:"7"; dce_stub_data; byte_test:4,>,37,28,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,17905; reference:cve,2006-1184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6420; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContextW heap overflow attempt"; flow:to_server,established; dce_iface:uuid 906b0ce0-c70b-1067-b317-00dd010662da; dce_opnum:"7"; dce_stub_data; byte_jump:4,28,dce,multiplier 2,post_offset 10; byte_jump:4,0,relative,dce,multiplier 2,post_offset 22; byte_jump:4,0,relative,dce,multiplier 2,post_offset 10; byte_test:4,>,100,0,relative,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,17905; reference:cve,2006-1184; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6431; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msdtc BuildContextW heap overflow attempt"; flow:to_server,established; dce_iface:uuid 906b0ce0-c70b-1067-b317-00dd010662da; dce_opnum:"7"; dce_stub_data; byte_jump:4,28,dce,multiplier 2,post_offset 10; byte_jump:4,0,relative,dce,multiplier 2,post_offset 10; byte_test:4,>,100,0,relative,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:bugtraq,17906; reference:cve,2006-0034; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-018; classtype:attempted-admin; sid:6443; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rras RasRpcSubmitRequest overflow attempt"; flow:to_server,established; dce_iface:uuid 20610036-fa22-11cf-9823-00a0c911e5df; dce_opnum:"10 12"; dce_stub_data; byte_test:4,>,2532,4,dce; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:bugtraq,18325; reference:cve,2006-2370; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-025; classtype:attempted-admin; sid:6584; rev:19; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rras RasRpcSetUserPreferences phonebook mode overflow attempt"; flow:to_server,established; dce_iface:uuid 20610036-fa22-11cf-9823-00a0c911e5df; dce_opnum:"10"; dce_stub_data; byte_test:4,>,34,68,dce; service:netbios-ssn; reference:bugtraq,18358; reference:cve,2006-2371; reference:url,technet.microsoft.com/en-us/security/bulletin/MS06-025; classtype:attempted-admin; sid:6714; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP msqueue function 4 overflow attempt"; flow:to_server,established; dce_iface:uuid 975201b0-59ca-11d0-a8d5-00a0c90d8051; dce_opnum:"4"; dce_stub_data; byte_test:4,>,128,8,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:cve,2005-0059; reference:url,technet.microsoft.com/en-us/security/bulletin/MS05-017; classtype:attempted-admin; sid:9769; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP rpcss _RemoteGetClassObject attempt"; flow:to_server,established; dce_iface:uuid b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:"3"; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:11073; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET [135,1024:] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP rpcss _RemoteGetClassObject attempt"; dce_iface:uuid b9e79e60-3d52-11ce-aaa1-00006901293f; dce_opnum:"3"; metadata:policy max-detect-ips drop; reference:cve,2003-0605; reference:url,technet.microsoft.com/en-us/security/bulletin/MS03-039; classtype:protocol-command-decode; sid:11074; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP mqqm QMCreateObjectInternal overflow attempt"; flow:to_server,established; dce_iface:uuid fdb3a030-065f-11d1-bb9b-00a024ea5525; dce_opnum:"6"; dce_stub_data; byte_test:4,=,1,0,dce; byte_test:4,>,142,4,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:12977; rev:20; )
alert udp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP mqqm QMCreateObjectInternal overflow attempt"; dce_iface:uuid fdb3a030-065f-11d1-bb9b-00a024ea5525; dce_opnum:"6"; dce_stub_data; byte_test:4,=,1,0,dce; byte_test:4,>,142,4,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:12978; rev:18; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP mqqm QMObjectPathToObjectFormat overflow attempt"; flow:to_server,established; dce_iface:uuid fdb3a030-065f-11d1-bb9b-00a024ea5525; dce_opnum:"12"; dce_stub_data; byte_test:4,>,142,0,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:13210; rev:19; )
alert udp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP mqqm QMObjectPathToObjectFormat overflow attempt"; dce_iface:uuid fdb3a030-065f-11d1-bb9b-00a024ea5525; dce_opnum:"12"; dce_stub_data; byte_test:4,>,142,0,dce; metadata:policy max-detect-ips drop; service:dcerpc; reference:cve,2007-3039; reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-065; classtype:attempted-admin; sid:13211; rev:19; )
alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP spoolss EnumJobs attempt"; flow:to_client,established; dce_iface:uuid 12345678-1234-abcd-ef00-0123456789ab; dce_opnum:"4"; dce_stub_data; byte_jump:4,4,dce; byte_test:4,>,1024,1,relative,dce; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:cve,2008-1446; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-062; classtype:protocol-command-decode; sid:14710; rev:20; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP mqqm QMGetRemoteQueueName overflow attempt"; flow:to_server,established; dce_iface:uuid fdb3a030-065f-11d1-bb9b-00a024ea5525; dce_opnum:"1"; dce_stub_data; isdataat:16; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:cve,2008-3479; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-065; classtype:attempted-admin; sid:14725; rev:18; )
alert udp $EXTERNAL_NET any -> $HOME_NET [2103,2105,2107] ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP mqqm QMGetRemoteQueueName overflow attempt"; dce_iface:uuid fdb3a030-065f-11d1-bb9b-00a024ea5525; dce_opnum:"1"; dce_stub_data; isdataat:16; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:cve,2008-3479; reference:url,technet.microsoft.com/en-us/security/bulletin/ms08-065; classtype:attempted-admin; sid:14726; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP host-integration bind attempt"; flow:to_server,established; dce_iface:uuid ed6ee250-e0d1-11cf-925a-00aa00c006c1; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:cve,2008-3466; reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-059; classtype:protocol-command-decode; sid:14737; rev:16; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [135,139,445,593,1024:] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP wkssvc NetrGetJoinInformation attempt"; flow:to_server,established; dce_iface:uuid 6bffd098-a112-3610-9833-46c3f87e345a; dce_opnum:"20"; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:cve,2009-1544; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-041; classtype:protocol-command-decode; sid:15860; rev:13; )
alert tcp $EXTERNAL_NET any -> $HTTP_SERVERS $HTTP_PORTS ( msg:"OS-WINDOWS Microsoft ISA and Forefront Threat Management Web Proxy TCP Listener denial of service attempt"; flow:to_server,established; seq:3927875496; flags:R; metadata:policy max-detect-ips drop; service:http; reference:bugtraq,34414; reference:cve,2009-0077; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-016; classtype:attempted-dos; sid:16221; rev:12; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP llsrpc2 LlsrLicenseRequestW overflow attempt"; flow:to_server,established; dce_iface:uuid 57674cd0-5200-11ce-a897-08002b2e9c6d; dce_opnum:"0"; dce_stub_data; byte_jump:4,8,dce,multiplier 2; byte_test:4,>,256,16,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-ssn; reference:cve,2009-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-064; classtype:attempted-admin; sid:16238; rev:11; )
alert udp $EXTERNAL_NET any -> $HOME_NET 138 ( msg:"OS-WINDOWS DCERPC NCADG-IP-UDP llsrpc2 LlsrLicenseRequestW overflow attempt"; dce_iface:uuid 57674cd0-5200-11ce-a897-08002b2e9c6d; dce_opnum:"0"; dce_stub_data; byte_jump:4,8,dce,multiplier 2; byte_test:4,>,256,16,relative,dce; metadata:policy max-detect-ips drop,policy security-ips drop; service:netbios-dgm; reference:cve,2009-2523; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-064; classtype:attempted-admin; sid:16239; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows TCP stack zero window size exploit attempt"; flow:to_server,established; seq:2; ack:1204835598; window:4; flags:A; metadata:policy max-detect-ips drop; reference:bugtraq,31545; reference:cve,2008-4609; reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-048; classtype:attempted-dos; sid:16294; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [139,445] ( msg:"OS-WINDOWS DCERPC NCACN-IP-TCP srvsvc NetrDfsCreateExitPoint dos attempt"; flow:to_server,established; dce_iface:uuid 4b324fc8-1670-01d3-1278-5a47bf6ee188; dce_opnum:"48"; dce_stub_data; byte_test:4,>,65535,56,dce; metadata:policy max-detect-ips drop; service:netbios-ssn; reference:bugtraq,15460; reference:cve,2005-3644; reference:url,technet.microsoft.com/en-us/security/advisory/911052; classtype:attempted-dos; sid:17702; rev:12; )
alert tcp $HOME_NET any -> $HOME_NET 42 ( msg:"OS-WINDOWS Microsoft WINS service oversize payload exploit attempt"; flow:to_server,established,no_stream; isdataat:1400; metadata:policy max-detect-ips drop; reference:cve,2011-1248; reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-035; classtype:attempted-admin; sid:18950; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3389 ( msg:"OS-WINDOWS Microsoft Windows RDP RST denial of service attempt"; flow:to_server,no_stream; flags:R; detection_filter:track by_src,count 200,seconds 1; metadata:policy max-detect-ips drop; reference:cve,2012-0152; reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-001; classtype:attempted-dos; sid:21568; rev:9; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-WINDOWS Microsoft Windows TCP/IP Remote Code Execution Vulnerability attempt"; ip_proto:44; detection_filter:track by_dst,count 100,seconds 1; reference:cve,2021-24086; reference:cve,2021-24094; reference:cve,2023-38160; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-24086; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2021-24094; reference:url,portal.msrc.microsoft.com/en-us/security-guidance/advisory/CVE-2023-38160; classtype:attempted-user; gid:1; sid:57193; rev:3; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-LINUX kernel SCTP chunkless packet denial of service attempt"; ip_proto:132; dsize:12; metadata:policy max-detect-ips drop; reference:bugtraq,18755; reference:cve,2006-2934; classtype:attempted-dos; sid:7021; rev:9; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-LINUX Linux kernel SCTP Unknown Chunk Types denial of service attempt"; ip_proto:132; dsize:>12; byte_test:1,>,14,12; metadata:policy max-detect-ips drop; reference:bugtraq,24376; reference:bugtraq,54797; reference:cve,2007-2876; classtype:attempted-dos; sid:17302; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"OS-LINUX Linux Kernel Challenge ACK provocation attempt"; flow:to_server,no_stream; flags:R; detection_filter:track by_src,count 200,seconds 1; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,91704; reference:cve,2016-5696; reference:cve,2017-7285; classtype:attempted-admin; sid:40063; rev:5; )
alert udp $EXTERNAL_NET any -> $HOME_NET 69 ( msg:"PROTOCOL-TFTP Multiple TFTP product buffer overflow attempt"; flow:to_server; dsize:>515; metadata:policy max-detect-ips drop; service:tftp; reference:bugtraq,20131; reference:bugtraq,45378; reference:bugtraq,46434; reference:bugtraq,47789; reference:bugtraq,8505; reference:cve,2003-0729; reference:cve,2006-4948; reference:cve,2008-1610; reference:cve,2010-4323; reference:cve,2011-1852; reference:url,secunia.com/advisories/43819; classtype:attempted-admin; sid:18767; rev:12; )
alert tcp $EXTERNAL_NET 502 -> $HOME_NET any ( msg:"PROTOCOL-SCADA Modbus exception returned"; flow:to_client,established; byte_test:1,&,128,7; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15071; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus user-defined function code - 65 to 72"; flow:to_server,established; byte_test:1,>,64,7; byte_test:1,<,73,7; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15074; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus user-defined function code - 100 to 110"; flow:to_server,established; byte_test:1,>,99,7; byte_test:1,<,111,7; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15075; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus write multiple coils - too many outputs"; flow:to_server,established; modbus_func:write_multiple_coils; byte_test:2,>,1968,10; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15076; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read multiple coils - too many inputs"; flow:to_server,established; modbus_func:read_coils; byte_test:2,>,2000,10; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:15077; rev:7; )
alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any ( msg:"PROTOCOL-SCADA DNP3 device trouble"; flow:to_client,established; dnp3_ind:"device_trouble"; metadata:policy max-detect-ips drop; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15713; rev:6; )
alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any ( msg:"PROTOCOL-SCADA DNP3 corrupt configuration"; flow:to_client,established; dnp3_ind:"config_corrupt"; metadata:policy max-detect-ips drop; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15714; rev:6; )
alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any ( msg:"PROTOCOL-SCADA DNP3 event buffer overflow error"; flow:to_client,established; dnp3_ind:"event_buffer_overflow"; metadata:policy max-detect-ips drop; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15715; rev:6; )
alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any ( msg:"PROTOCOL-SCADA DNP3 parameter error"; flow:to_client,established; dnp3_ind:"parameter_error"; metadata:policy max-detect-ips drop; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15716; rev:6; )
alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any ( msg:"PROTOCOL-SCADA DNP3 unknown object error"; flow:to_client,established; dnp3_ind:"object_unknown"; metadata:policy max-detect-ips drop; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15717; rev:6; )
alert tcp $EXTERNAL_NET 20000 -> $HOME_NET any ( msg:"PROTOCOL-SCADA DNP3 unsupported function code error"; flow:to_client,established; dnp3_ind:"no_func_code_support"; metadata:policy max-detect-ips drop; reference:url,www.dnp.org/About/Default.aspx; classtype:protocol-command-decode; sid:15718; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus write multiple registers from external source"; flow:to_server,established; modbus_func:write_multiple_registers; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17782; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus write single register from external source"; flow:to_server,established; modbus_func:write_single_register; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17783; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus write single coil from external source"; flow:to_server,established; modbus_func:write_single_coil; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17784; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus write multiple coils from external source"; flow:to_server,established; modbus_func:write_multiple_coils; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17785; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus write file record from external source"; flow:to_server,established; modbus_func:write_file_record; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17786; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read discrete inputs from external source"; flow:to_server,established; modbus_func:read_discrete_inputs; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17787; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read coils from external source"; flow:to_server,established; modbus_func:read_coils; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17788; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read input register from external source"; flow:to_server,established; modbus_func:read_input_registers; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17789; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read holding registers from external source"; flow:to_server,established; modbus_func:read_holding_registers; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17790; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read/write multiple registers from external source"; flow:to_server,established; modbus_func:read_write_multiple_registers; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17791; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read fifo queue from external source"; flow:to_server,established; modbus_func:read_fifo_queue; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17792; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read file record from external source"; flow:to_server,established; modbus_func:read_file_record; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17793; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read exception status from external source"; flow:to_server,established; modbus_func:read_exception_status; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17794; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus initiate diagnostic from external source"; flow:to_server,established; modbus_func:diagnostics; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17795; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus get com event counter from external source"; flow:to_server,established; modbus_func:get_comm_event_counter; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17796; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus get com event log from external source"; flow:to_server,established; modbus_func:get_comm_event_log; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17797; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus report slave id from external source"; flow:to_server,established; modbus_func:report_slave_id; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17798; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus read device identification from external source"; flow:to_server,established; modbus_func:report_slave_id; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17799; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 502 ( msg:"PROTOCOL-SCADA Modbus mask write register from external source"; flow:to_server,established; modbus_func:mask_write_register; metadata:policy max-detect-ips drop; reference:url,www.modbus.org/docs/Modbus_Application_Protocol_V1_1b.pdf; classtype:protocol-command-decode; sid:17800; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [12397,12399] ( msg:"PROTOCOL-SCADA Schneider Electric IGSS integer underflow attempt"; flow:to_server,established; byte_test:4,>,0x800,8,little; metadata:policy max-detect-ips drop; reference:cve,2013-0657; classtype:attempted-user; sid:25850; rev:9; )
alert udp any any -> any any ( msg:"PROTOCOL-SCADA PNIO-CM Connect Operation"; dce_iface:uuid dea00001-6c97-11d1-8271-00a02442df7d,any_frag; dce_opnum:"0"; metadata:policy max-detect-ips drop; service:dcerpc; reference:url,wiki.wireshark.org/PROFINET/IO; classtype:protocol-command-decode; sid:48576; rev:2; )
alert tcp any any -> any any ( msg:"PROTOCOL-SCADA PNIO-CM Connect Operation"; flow:to_server,established; dce_iface:uuid dea00001-6c97-11d1-8271-00a02442df7d,any_frag; dce_opnum:"0"; metadata:policy max-detect-ips drop; service:dcerpc; reference:url,wiki.wireshark.org/PROFINET/IO; classtype:protocol-command-decode; sid:48577; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [46824,46825] ( msg:"PROTOCOL-SCADA Sielco Sistemi Winlog Lite buffer overflow attempt"; flow:to_server,established; isdataat:282; metadata:policy max-detect-ips drop; reference:cve,2012-3815; reference:url,aluigi.altervista.org/adv/winlog_2-adv.txt; reference:url,www.s3cur1ty.de/m1adv2012-001; reference:url,www.securityfocus.com/bid/53811; reference:url,www.sielcosistemi.com/en/download/public/winlog_lite.html; classtype:attempted-user; sid:51030; rev:2; )
alert udp any 19 <> any 7 ( msg:"SERVER-OTHER UDP echo+chargen bomb"; flow:to_server; metadata:policy max-detect-ips drop,ruleset community; reference:cve,1999-0103; reference:cve,1999-0635; classtype:attempted-dos; sid:271; rev:12; )
alert udp $EXTERNAL_NET any -> $HOME_NET 161 ( msg:"SERVER-OTHER Bay/Nortel Nautica Marlin"; flow:to_server; dsize:0; metadata:policy max-detect-ips drop,ruleset community; reference:bugtraq,1009; reference:cve,2000-0221; classtype:attempted-dos; sid:279; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 135:139 ( msg:"SERVER-OTHER Winnuke attack"; flow:stateless; flags:U+; metadata:ruleset community; reference:bugtraq,2010; reference:cve,1999-0153; classtype:attempted-dos; sid:1257; rev:15; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 3372 ( msg:"SERVER-OTHER MSDTC attempt"; flow:to_server,established; isdataat:1023; metadata:ruleset community; reference:bugtraq,4006; reference:cve,2002-0224; reference:nessus,10939; classtype:attempted-dos; sid:1408; rev:17; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6789:6790 ( msg:"SERVER-OTHER DB2 dos attempt"; flow:to_server,established; isdataat:0; isdataat:!1; metadata:ruleset community; reference:bugtraq,3010; reference:cve,2001-1143; reference:nessus,10871; classtype:denial-of-service; sid:1641; rev:16; )
alert ip any any -> any any ( msg:"SERVER-OTHER Ethereal IGMP IGAP account overflow attempt"; ip_proto:2; byte_test:1,>,63,0; byte_test:1,<,67,0; byte_test:1,>,16,12; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2462; rev:10; )
alert ip any any -> any any ( msg:"SERVER-OTHER Ethereal IGMP IGAP message overflow attempt"; ip_proto:2; byte_test:1,>,63,0; byte_test:1,<,67,0; byte_test:1,>,64,13; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2463; rev:10; )
alert ip any any -> any any ( msg:"SERVER-OTHER Ethereal EIGRP prefix length overflow attempt"; ip_proto:88; byte_test:1,>,32,44; metadata:ruleset community; reference:bugtraq,9952; reference:cve,2004-0176; reference:cve,2004-0367; classtype:attempted-admin; sid:2464; rev:10; )
alert tcp $EXTERNAL_NET any <> $HOME_NET 179 ( msg:"SERVER-OTHER BGP spoofed connection reset attempt"; flow:established,no_stream; flags:FRS*; detection_filter:track by_dst,count 10,seconds 10; metadata:ruleset community; reference:bugtraq,10183; reference:cve,2004-0230; reference:url,www.uniras.gov.uk/vuls/2004/236929/index.htm; classtype:attempted-dos; sid:2523; rev:15; )
alert udp $EXTERNAL_NET any -> $HOME_NET 41524 ( msg:"SERVER-OTHER ARCserve discovery service overflow"; flow:to_server; dsize:>966; metadata:policy max-detect-ips drop; reference:bugtraq,12491; reference:cve,2005-0260; classtype:attempted-admin; sid:3472; rev:6; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 13724 ( msg:"SERVER-OTHER VERITAS NetBackup vnetd buffer overflow attempt"; flow:to_server,established; flowbits:isset,vnetd.bpspsserver.connection; byte_test:4,>,1024,0; isdataat:1024; flowbits:unset,vnetd.bpspsserver.connection; metadata:policy max-detect-ips drop; reference:bugtraq,17264; reference:cve,2006-0991; classtype:attempted-admin; sid:6011; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 13701 ( msg:"SERVER-OTHER Veritas NetBackup Volume Manager connection attempt"; flow:to_server,established; byte_test:1,>,3,10,string,dec; byte_test:1,<,11,10,string,dec; flowbits:set,veritas.vmd.connect; flowbits:noalert; classtype:protocol-command-decode; sid:6404; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET 5093 ( msg:"SERVER-OTHER Sentinel license manager buffer overflow attempt"; flow:to_server; dsize:>836; metadata:policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,12742; reference:cve,2005-0353; reference:cve,2020-10291; classtype:attempted-admin; sid:11265; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 20031 ( msg:"SERVER-OTHER BakBone NetVault server heap overflow attempt"; flow:to_server,established; stream_size:>32784,to_server; byte_test:4,>,32784,0,little; metadata:policy max-detect-ips drop; reference:bugtraq,12967; reference:cve,2005-1009; classtype:attempted-admin; sid:12081; rev:10; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 21064 ( msg:"SERVER-OTHER Ingres long message heap buffer overflow attempt"; flow:to_server,established; isdataat:1169; byte_test:2,>,1168,0,little; metadata:policy max-detect-ips drop; reference:cve,2007-3334; classtype:attempted-admin; sid:12202; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET 2048 ( msg:"SERVER-OTHER Squid proxy long WCCP packet"; flow:to_server; dsize:>1428; metadata:policy max-detect-ips drop; reference:bugtraq,12432; reference:cve,2005-0211; classtype:attempted-user; sid:12222; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 13701 ( msg:"SERVER-OTHER Veritas NetBackup vmd shared library buffer overflow attempt"; flow:to_server,established; isdataat:3; isdataat:!4; byte_test:1,>,80,0; metadata:policy max-detect-ips drop; reference:bugtraq,15353; reference:cve,2005-3116; classtype:attempted-admin; sid:12904; rev:8; )
alert udp $EXTERNAL_NET any -> $HOME_NET [138,1024:] ( msg:"SERVER-OTHER DCERPC NCADG-IP-UDP lsarpc LsarLookupSids translated_names overflow attempt"; dce_iface:uuid 12345778-1234-abcd-ef00-0123456789ab; dce_opnum:"15"; dce_stub_data; byte_test:4,>,255,36,dce; metadata:policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,24196; reference:cve,2007-2446; classtype:protocol-command-decode; sid:15508; rev:7; )
alert udp $EXTERNAL_NET 123 -> $HOME_NET 123 ( msg:"SERVER-OTHER ntp mode 7 denial of service attempt"; byte_test:1,&,4,0; byte_test:1,&,2,0; byte_test:1,&,1,0; metadata:policy max-detect-ips drop; reference:bugtraq,37255; reference:cve,2009-3563; reference:url,attack.mitre.org/techniques/T1209; classtype:attempted-dos; sid:16350; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 705 ( msg:"SERVER-OTHER RealNetworks Helix AgentX receive_agentx stack buffer overflow attempt"; flow:to_server,established; isdataat:!19; metadata:policy max-detect-ips drop; reference:bugtraq,39564; reference:cve,2010-1318; reference:url,labs.idefense.com/intelligence/vulnerabilities/display.php?id=867; classtype:attempted-admin; sid:16576; rev:14; )
alert tcp $EXTERNAL_NET any -> $HOME_NET [1918,6014,10110,14206,18302] ( msg:"SERVER-OTHER IBM Tivoli Monitoring Express Universal Agent Buffer Overflow"; flow:to_server,established; stream_size:>4098,to_server; metadata:policy max-detect-ips drop; reference:bugtraq,23558; reference:cve,2007-2137; classtype:attempted-admin; sid:17298; rev:9; )
alert udp $EXTERNAL_NET any -> $HOME_NET 4011 ( msg:"SERVER-OTHER Fujitsu SystemcastWizard Lite PXEService UDP Handling Buffer Overflow"; flow:to_server; dsize:>1024; metadata:policy max-detect-ips drop; reference:bugtraq,33342; reference:cve,2009-0270; classtype:attempted-admin; sid:17524; rev:8; )
alert udp $EXTERNAL_NET !53 -> $HOME_NET 65535 ( msg:"SERVER-OTHER LANDesk Management Suite Alerting Service buffer overflow attempt"; flow:to_server; dsize:>268; metadata:policy max-detect-ips drop; reference:bugtraq,23483; reference:cve,2007-1674; classtype:attempted-admin; sid:17567; rev:8; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6504 ( msg:"SERVER-OTHER CA BightStor ARCserver Backup possible insecure method access"; flow:to_server,established; dce_iface:uuid 506b1890-14c8-11d1-bbc3-00805fa6962e; dce_opnum:"383-396"; metadata:policy max-detect-ips drop,policy security-ips drop; service:dcerpc; reference:cve,2007-5328; reference:url,secunia.com/advisories/27192/; classtype:attempted-user; sid:17577; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6503 ( msg:"SERVER-OTHER BrightStor ARCserve backup tape engine buffer overflow attempt"; flow:to_server,established; dce_iface:uuid dc246bf0-7a7a-11ce-9f88-00805fe43838; dce_opnum:"45"; isdataat:500; metadata:policy max-detect-ips drop,policy security-ips drop; reference:bugtraq,21221; reference:cve,2006-6076; classtype:attempted-admin; sid:18285; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-OTHER SSL CBC encryption mode weakness brute force attempt"; flow:to_server,established,no_stream; isdataat:1; isdataat:!1001; detection_filter:track by_src,count 100,seconds 1; metadata:policy max-detect-ips drop; service:ssl; reference:cve,2011-3389; reference:url,attack.mitre.org/techniques/T1110; reference:url,technet.microsoft.com/en-us/security/advisory/2588513; reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-006; reference:url,vnhacker.blogspot.com/2011/09/beast.html; classtype:attempted-recon; sid:20212; rev:11; )
alert tcp $EXTERNAL_NET 20031 -> $HOME_NET any ( msg:"SERVER-OTHER BakBone NetVault client heap overflow attempt"; flow:to_client,established; stream_size:>32784,to_client; byte_test:4,>,32784,0,little; metadata:policy max-detect-ips drop; reference:bugtraq,12967; reference:cve,2005-1009; classtype:attempted-admin; sid:20546; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 6070 ( msg:"SERVER-OTHER CA BrightStor Agent for Microsoft SQL overflow attempt"; flow:to_server,established; isdataat:1300; byte_test:2,>,0x6e2,694; metadata:policy max-detect-ips drop; reference:bugtraq,14453; reference:cve,2005-1272; classtype:attempted-admin; sid:21663; rev:11; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 37452 ( msg:"SERVER-OTHER Quest NetVault SmartDisk libnvbasics.dll denial of service attempt"; flow:to_server,established; byte_test:4,>,1000000000,0,little; isdataat:!5; metadata:policy max-detect-ips drop; reference:bugtraq,48029; reference:url,telussecuritylabs.com/threats/show/TSL20110602-02; classtype:denial-of-service; sid:24627; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET [514,515] ( msg:"SERVER-OTHER HP HP Intelligent Management Center syslog remote code execution attempt"; flow:to_server; dsize:>2047; metadata:policy max-detect-ips drop; service:syslog; reference:cve,2011-1854; classtype:attempted-admin; sid:25352; rev:7; )
alert tcp $EXTERNAL_NET 70 -> $HOME_NET any ( msg:"SERVER-OTHER Squid Gopher response processing buffer overflow attempt"; flow:to_client,established; isdataat:1024; metadata:policy max-detect-ips drop; service:gopher; reference:bugtraq,49356; reference:cve,2011-3205; reference:url,www.secunia.com/advisories/45805; reference:url,www.squid-cache.org/Advisories/SQUID-2011_3.txt; classtype:attempted-user; sid:25356; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 443 ( msg:"SERVER-OTHER SSL TLS deflate compression weakness brute force attempt"; flow:to_server,established,no_stream; flowbits:isset,tls.deflate; isdataat:0; isdataat:!1000; detection_filter:track by_src,count 500,seconds 1; metadata:policy max-detect-ips drop; service:ssl; reference:bugtraq,55704; reference:cve,2012-4929; reference:url,attack.mitre.org/techniques/T1110; classtype:attempted-recon; sid:26645; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 705 ( msg:"SERVER-OTHER RealNetworks Helix snmp master agent denial of service attempt"; flow:to_server,established; flags:AF; stream_size:<=2,to_server; metadata:policy max-detect-ips drop; service:snmp; reference:bugtraq,52929; reference:cve,2012-1923; classtype:attempted-dos; sid:26980; rev:7; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 13701 ( msg:"SERVER-OTHER Veritas NetBackup Volume Manager connection attempt"; flow:to_server,established; byte_test:1,>,3,14,string,dec; byte_test:1,<,11,14,string,dec; flowbits:set,veritas.vmd.connect; flowbits:noalert; metadata:policy max-detect-ips alert; classtype:protocol-command-decode; sid:37546; rev:5; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 143 ( msg:"SERVER-OTHER IBM Lotus Domino IMAP server CRAM-MD5 authentication buffer overflow attempt"; flow:to_server; flowbits:isset,file.crammd5; isdataat:273; metadata:policy max-detect-ips drop,policy security-ips drop; service:imap; reference:cve,2007-1675; reference:url,www-01.ibm.com/support/docview.wss?uid=swg21257028; classtype:attempted-admin; sid:43068; rev:4; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 5405 ( msg:"SERVER-OTHER NetSupport Manager client buffer overflow attempt"; flow:to_server,established; isdataat:800; metadata:policy max-detect-ips drop; reference:bugtraq,45728; reference:cve,2011-0404; classtype:attempted-admin; sid:50896; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 16102 ( msg:"SERVER-OTHER Blue Coat BCAAA buffer overflow attempt"; flow:to_server,established; isdataat:1065; byte_test:4,>,1064,0; metadata:policy max-detect-ips drop; reference:cve,2011-5124; reference:url,seclists.org/bugtraq/2011/Jul/44; classtype:attempted-admin; sid:50914; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 8009 ( msg:"SERVER-OTHER Novell Open Enterprise Server 2 HTTPSTK service denial-of-service attempt"; flow:stateless; flags:S; detection_filter:track by_src,count 40,seconds 5; metadata:policy max-detect-ips drop; reference:cve,2013-3707; reference:url,support.microfocus.com/kb/doc.php?id=7014063; classtype:denial-of-service; sid:50919; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET 13666 ( msg:"SERVER-OTHER LCDproc Server test_func_func stack buffer overflow attempt"; flow:to_server,established; isdataat:1323; metadata:policy max-detect-ips drop; reference:cve,2004-1916; classtype:attempted-user; sid:51041; rev:1; )
alert ip $EXTERNAL_NET any -> $HOME_NET any ( msg:"POLICY-OTHER IPv6 packets encapsulated in IPv4"; ip_proto:41; reference:bugtraq,29235; reference:cve,2008-2136; classtype:policy-violation; sid:8446; rev:9; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"POLICY-OTHER TCP packet with urgent flag attempt"; flow:stateless; flags:U+; metadata:policy max-detect-ips drop; classtype:protocol-command-decode; sid:24378; rev:4; )
alert ip any any -> any any ( msg:"POLICY-OTHER IP option loose source routing attempt"; ipopts:lsrr; reference:cve,2019-12256; classtype:protocol-command-decode; sid:51034; rev:1; )
alert ip any any -> any any ( msg:"POLICY-OTHER IP option strict source routing attempt"; ipopts:ssrr; reference:cve,2019-12256; classtype:protocol-command-decode; sid:51035; rev:1; )
alert ip any any -> any any ( msg:"POLICY-OTHER IP option loose source routing attempt"; ipopts:lsrre; reference:cve,2019-12256; classtype:protocol-command-decode; sid:51036; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"POLICY-OTHER TCP FIN packet and URG set attempt"; flow:stateless; flags:FU+; reference:cve,2019-12260; classtype:protocol-command-decode; sid:51065; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"POLICY-OTHER TCP SYN packet and URG set attempt"; flow:stateless; flags:SU+; reference:cve,2019-12260; classtype:protocol-command-decode; sid:51066; rev:1; )
alert ip any any -> any any ( msg:"POLICY-OTHER Potentially suspicious fragmented IP in IP packet"; ip_proto:4; fragbits:M; dsize:<55; reference:cve,2020-11896; reference:url,treck.com/vulnerability-response-information/; classtype:policy-violation; sid:54383; rev:3; )
alert udp $EXTERNAL_NET any -> $HOME_NET 4569 ( msg:"PROTOCOL-VOIP Digium Asterisk IAX2 truncated full-frame packet overflow attempt"; flow:to_server; dsize:<12; byte_test:2,&,32768,0; metadata:policy max-detect-ips drop; reference:bugtraq,18307; reference:cve,2006-2923; classtype:attempted-admin; sid:6514; rev:6; )
alert udp $EXTERNAL_NET any -> $HOME_NET 4569 ( msg:"PROTOCOL-VOIP Digium Asterisk IAX2 truncated mini-frame packet overflow attempt"; flow:to_server; dsize:<4; byte_test:2,<,32768,0; metadata:policy max-detect-ips drop; reference:bugtraq,18307; reference:cve,2006-2923; classtype:attempted-admin; sid:6515; rev:6; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS 2000 ( msg:"PROTOCOL-VOIP Digium Asterisk data length field overflow attempt"; flow:to_server,established; isdataat:992; byte_test:4,>,992,0,little; metadata:policy max-detect-ips drop; reference:bugtraq,20617; reference:cve,2006-5444; reference:url,www.exploit-db.com/exploits/2597; classtype:attempted-user; sid:12359; rev:11; )
alert udp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP INVITE flood attempt"; flow:to_server; sip_method:invite; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop; service:sip; reference:cve,2008-5180; reference:cve,2017-6648; reference:url,tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-20170607-tele; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20396; rev:8; )
alert tcp $EXTERNAL_NET any -> $SIP_SERVERS $SIP_PORTS ( msg:"PROTOCOL-VOIP INVITE flood"; flow:to_server,established,only_stream; sip_method:invite; detection_filter:track by_src,count 100,seconds 25; metadata:policy max-detect-ips drop; service:sip; reference:cve,2008-5180; reference:url,www.ietf.org/rfc/rfc3261.txt; classtype:attempted-dos; sid:20397; rev:6; )
alert tcp $SQL_SERVERS 3306 -> $EXTERNAL_NET any ( msg:"SERVER-MYSQL server greeting finished"; flow:to_client,established; byte_test:1,>,0,3; flowbits:isset,mysql.server_greeting; flowbits:unset,mysql.server_greeting; flowbits:noalert; service:mysql; reference:bugtraq,10655; reference:cve,2004-0627; reference:nessus,12639; reference:url,www.nextgenss.com/advisories/mysql-authbypass.txt; classtype:attempted-user; sid:3666; rev:14; )
